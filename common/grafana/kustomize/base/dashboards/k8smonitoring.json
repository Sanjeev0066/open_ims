{"annotations":{"list":[{"builtIn":1,"datasource":{"type":"datasource","uid":"grafana"},"enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","type":"dashboard"}]},"description":"Kubernetes Pod Resource Overview. node-exporter and kubelet-cadvisor required.","editable":true,"fiscalYearStartMonth":0,"gnetId":13077,"graphTooltip":0,"links":[],"panels":[{"collapsed":false,"datasource":{"type":"prometheus","uid":"ims-prom"},"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":34,"panels":[],"targets":[{"datasource":{"type":"prometheus","uid":"ims-prom"},"refId":"A"}],"title":"Total usage","type":"row"},{"datasource":{"type":"prometheus","uid":"$DataSource"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"max":100,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"rgba(50, 172, 45, 0.97)","value":null},{"color":"rgba(237, 129, 40, 0.89)","value":65},{"color":"rgba(245, 54, 54, 0.9)","value":90}]},"unit":"percent"},"overrides":[]},"gridPos":{"h":5,"w":8,"x":0,"y":1},"id":4,"maxDataPoints":100,"options":{"colorMode":"value","graphMode":"none","justifyMode":"center","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"text":{},"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"uid":"$DataSource"},"editorMode":"code","expr":"sum(container_memory_working_set_bytes{kubernetes_io_hostname=~\"^$Node$\",container!=\"\"}) by (kubernetes_io_hostname) / sum (machine_memory_bytes{kubernetes_io_hostname=~\"^$Node$\"}) by (kubernetes_io_hostname) * 100","interval":"10s","intervalFactor":1,"legendFormat":"{{kubernetes_io_hostname}}","range":true,"refId":"A","step":10}],"title":"Node memory usage","type":"stat"},{"datasource":{"type":"prometheus","uid":"$DataSource"},"fieldConfig":{"defaults":{"decimals":2,"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"max":100,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"rgba(50, 172, 45, 0.97)","value":null},{"color":"rgba(237, 129, 40, 0.89)","value":65},{"color":"rgba(245, 54, 54, 0.9)","value":90}]},"unit":"percent"},"overrides":[]},"gridPos":{"h":5,"w":8,"x":8,"y":1},"id":6,"maxDataPoints":100,"options":{"colorMode":"value","graphMode":"none","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"uid":"$DataSource"},"editorMode":"code","expr":"sum (rate (container_cpu_usage_seconds_total{id=\"/\",kubernetes_io_hostname=~\"^$Node$\"}[1m])) by (kubernetes_io_hostname) / sum (machine_cpu_cores{kubernetes_io_hostname=~\"^$Node$\"}) by (kubernetes_io_hostname) * 100","interval":"10s","intervalFactor":1,"legendFormat":"{{label_name}}","range":true,"refId":"A","step":10}],"title":"Node CPU usage (1m avg)","type":"stat"},{"datasource":{"type":"prometheus","uid":"$DataSource"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"decimals":2,"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"max":100,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"rgba(50, 172, 45, 0.97)","value":null},{"color":"rgba(237, 129, 40, 0.89)","value":65},{"color":"rgba(245, 54, 54, 0.9)","value":90}]},"unit":"percent"},"overrides":[]},"gridPos":{"h":5,"w":8,"x":16,"y":1},"id":7,"maxDataPoints":100,"options":{"displayMode":"gradient","maxVizHeight":300,"minVizHeight":16,"minVizWidth":8,"namePlacement":"auto","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showUnfilled":true,"sizing":"auto","valueMode":"color"},"pluginVersion":"11.1.3","targets":[{"datasource":{"uid":"$DataSource"},"editorMode":"code","exemplar":false,"expr":"(node_filesystem_size_bytes{device=~\".*dev.*\",instance=~\"$host\"} - node_filesystem_avail_bytes{device=~\".*dev.*\",instance=~\"$host\"}) / (node_filesystem_size_bytes{device=~\".*dev.*\",instance=~\"$host\"}) * 100","instant":false,"interval":"10s","intervalFactor":1,"legendFormat":"{{instance}} {{device}}","metric":"","range":true,"refId":"A","step":10}],"title":"Node filesystem usage","type":"bargauge"},{"datasource":{"type":"prometheus","uid":"$DataSource"},"fieldConfig":{"defaults":{"decimals":2,"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"bytes"},"overrides":[]},"gridPos":{"h":3,"w":4,"x":0,"y":6},"id":9,"maxDataPoints":100,"options":{"colorMode":"none","graphMode":"none","justifyMode":"auto","orientation":"horizontal","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"uid":"$DataSource"},"editorMode":"code","expr":"sum (container_memory_working_set_bytes{kubernetes_io_hostname=~\"^$Node$\",container!=\"\"}) by (kubernetes_io_hostname)","interval":"10s","intervalFactor":1,"legendFormat":"{{kubernetes_io_hostname}}","range":true,"refId":"A","step":10}],"title":"Used","type":"stat"},{"datasource":{"type":"prometheus","uid":"$DataSource"},"fieldConfig":{"defaults":{"decimals":2,"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"bytes"},"overrides":[]},"gridPos":{"h":3,"w":4,"x":4,"y":6},"id":10,"maxDataPoints":100,"options":{"colorMode":"none","graphMode":"none","justifyMode":"auto","orientation":"horizontal","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"uid":"$DataSource"},"editorMode":"code","expr":"sum (machine_memory_bytes{kubernetes_io_hostname=~\"^$Node$\"}) by (kubernetes_io_hostname)","interval":"10s","intervalFactor":1,"legendFormat":"{{kubernetes_io_hostname}}","range":true,"refId":"A","step":10}],"title":"Total","type":"stat"},{"datasource":{"type":"prometheus","uid":"$DataSource"},"fieldConfig":{"defaults":{"decimals":2,"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"none"},"overrides":[]},"gridPos":{"h":3,"w":4,"x":8,"y":6},"id":11,"maxDataPoints":100,"options":{"colorMode":"none","graphMode":"none","justifyMode":"auto","orientation":"horizontal","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"uid":"$DataSource"},"editorMode":"code","expr":"sum(rate(container_cpu_usage_seconds_total{id=\"/\",kubernetes_io_hostname=~\"^$Node$\"}[1m])) by (kubernetes_io_hostname)","interval":"10s","intervalFactor":1,"legendFormat":"{{kubernetes_io_hostname}}","range":true,"refId":"A","step":10}],"title":"Used","type":"stat"},{"datasource":{"type":"prometheus","uid":"$DataSource"},"fieldConfig":{"defaults":{"decimals":2,"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"none"},"overrides":[]},"gridPos":{"h":3,"w":4,"x":12,"y":6},"id":12,"maxDataPoints":100,"options":{"colorMode":"none","graphMode":"none","justifyMode":"auto","orientation":"horizontal","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"uid":"$DataSource"},"editorMode":"code","expr":"sum (machine_cpu_cores{kubernetes_io_hostname=~\"^$Node$\"}) by (kubernetes_io_hostname)","interval":"10s","intervalFactor":1,"legendFormat":"{{kubernetes_io_hostname}}","range":true,"refId":"A","step":10}],"title":"Total","type":"stat"},{"datasource":{"type":"prometheus","uid":"$DataSource"},"fieldConfig":{"defaults":{"decimals":2,"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"bytes"},"overrides":[]},"gridPos":{"h":3,"w":4,"x":16,"y":6},"id":13,"maxDataPoints":100,"options":{"colorMode":"none","graphMode":"none","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"uid":"$DataSource"},"editorMode":"code","expr":"node_filesystem_size_bytes{device=~\"/dev/.*\",instance=~\"$host\"} - node_filesystem_avail_bytes{device=~\"/dev/.*\",instance=~\"$host\"}","interval":"10s","intervalFactor":1,"legendFormat":"{{instance}} {{device}}","range":true,"refId":"A","step":10}],"title":"Used","type":"stat"},{"datasource":{"type":"prometheus","uid":"$DataSource"},"fieldConfig":{"defaults":{"decimals":2,"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"bytes"},"overrides":[]},"gridPos":{"h":3,"w":4,"x":20,"y":6},"id":14,"maxDataPoints":100,"options":{"colorMode":"none","graphMode":"none","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"uid":"$DataSource"},"editorMode":"code","expr":"node_filesystem_size_bytes{device=~\"/dev/.*\",instance=~\"$host\"}","interval":"10s","intervalFactor":1,"legendFormat":"{{instance}}{{device}}","range":true,"refId":"A","step":10}],"title":"Total","type":"stat"},{"datasource":{"type":"prometheus","uid":"$DataSource"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"cores","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":17,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"none"},"overrides":[]},"gridPos":{"h":9,"w":12,"x":0,"y":9},"id":17,"options":{"legend":{"calcs":["mean","lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"desc"}},"targets":[{"datasource":{"uid":"$DataSource"},"editorMode":"code","expr":"sum(rate(container_cpu_usage_seconds_total{image!=\"\",namespace=~\"$namespace\",kubernetes_io_hostname=~\"^$Node$\"}[1m])) by (kubernetes_io_hostname,namespace,pod)","interval":"10s","intervalFactor":1,"legendFormat":"{{ kubernetes_io_hostname}} | {{ pod }}","metric":"container_cpu","range":true,"refId":"A","step":10}],"title":"Pods CPU usage (1m avg)","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"$DataSource"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"cores","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":21,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"none"},"overrides":[]},"gridPos":{"h":9,"w":12,"x":12,"y":9},"id":24,"options":{"legend":{"calcs":["mean","lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"desc"}},"targets":[{"datasource":{"uid":"$DataSource"},"editorMode":"code","expr":"sum (rate (container_cpu_usage_seconds_total{container!=\"\",namespace=~\"$namespace\",kubernetes_io_hostname=~\"^$Node$\"}[1m])) by (kubernetes_io_hostname,namespace, container)","interval":"10s","intervalFactor":1,"legendFormat":"{{ kubernetes_io_hostname }} | {{ container}}","metric":"container_cpu","range":true,"refId":"C","step":10}],"title":"Containers CPU usage (1m avg)","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"$DataSource"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":17,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"bytes"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":18},"id":25,"options":{"legend":{"calcs":["mean","lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true,"sortBy":"Mean","sortDesc":true,"width":200},"tooltip":{"mode":"multi","sort":"desc"}},"targets":[{"datasource":{"uid":"$DataSource"},"editorMode":"code","expr":"sum (container_memory_working_set_bytes{image!=\"\",namespace=~\"$namespace\",kubernetes_io_hostname=~\"^$Node$\"}) by (kubernetes_io_hostname,namespace,pod)","interval":"10s","intervalFactor":1,"legendFormat":"{{kubernetes_io_hostname}} | {{ pod }}","metric":"container_memory_usage:sort_desc","range":true,"refId":"A","step":10}],"title":"Pods memory usage","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"$DataSource"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":13,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"bytes"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":18},"id":27,"options":{"legend":{"calcs":["mean","lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true,"width":200},"tooltip":{"mode":"multi","sort":"desc"}},"targets":[{"datasource":{"uid":"$DataSource"},"editorMode":"code","expr":"sum (container_memory_working_set_bytes{image!=\"\",namespace=~\"$namespace\",container=~\".+\",kubernetes_io_hostname=~\"^$Node$\"}) by (kubernetes_io_hostname,namespace, container)","interval":"10s","intervalFactor":1,"legendFormat":"{{ kubernetes_io_hostname}} | {{ container }}","metric":"container_memory_usage:sort_desc","range":true,"refId":"A","step":10}],"title":"Containers memory usage","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"$DataSource"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"Bps"},"overrides":[]},"gridPos":{"h":10,"w":24,"x":0,"y":26},"id":16,"options":{"legend":{"calcs":["mean","lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true,"width":200},"tooltip":{"mode":"multi","sort":"desc"}},"targets":[{"datasource":{"uid":"$DataSource"},"editorMode":"code","expr":"sum (rate (container_network_receive_bytes_total{image!=\"\",namespace=~\"$namespace\",kubernetes_io_hostname=~\"^$Node$\"}[1m])) by (kubernetes_io_hostname, namespace, pod)","interval":"10s","intervalFactor":1,"legendFormat":"-> pod {{kubernetes_io_hostname}} {{ pod }}","metric":"network","range":true,"refId":"A","step":10},{"datasource":{"uid":"$DataSource"},"editorMode":"code","expr":"- sum (rate (container_network_transmit_bytes_total{image!=\"\",namespace=~\"$namespace\",kubernetes_io_hostname=~\"^$Node$\"}[1m])) by (kubernetes_io_hostname, namespace,pod)","interval":"10s","intervalFactor":1,"legendFormat":"<- pod {{kubernetes_io_hostname}} {{ pod }}","metric":"network","range":true,"refId":"B","step":10}],"title":"Pods network I/O (1m avg)","type":"timeseries"}],"refresh":"10s","schemaVersion":39,"tags":["kubernetes"],"templating":{"list":[{"allValue":".*","current":{"selected":true,"text":["ccg-ims-node-pool-1-bw1w5","ccg-ims-node-pool-1-bw1ws"],"value":["ccg-ims-node-pool-1-bw1w5","ccg-ims-node-pool-1-bw1ws"]},"datasource":{"type":"prometheus","uid":"$DataSource"},"definition":"label_values(kube_node_info, node)","hide":0,"includeAll":true,"multi":true,"name":"Node","options":[],"query":"label_values(kube_node_info, node)","refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tagsQuery":"","type":"query","useTags":false},{"current":{"selected":false,"text":"Prometheus","value":"ims-prom"},"hide":2,"includeAll":false,"multi":false,"name":"DataSource","options":[],"query":"prometheus","refresh":1,"regex":"Prometheus","skipUrlSync":false,"type":"datasource"},{"allValue":"","current":{"selected":true,"text":["All"],"value":["$__all"]},"datasource":{"type":"prometheus","uid":"ims-prom"},"definition":"label_values(kube_namespace_status_phase,namespace)","hide":0,"includeAll":true,"label":"Namespace","multi":true,"name":"namespace","options":[],"query":{"qryType":1,"query":"label_values(kube_namespace_status_phase,namespace)","refId":"PrometheusVariableQueryEditor-VariableQuery"},"refresh":1,"regex":"","skipUrlSync":false,"sort":1,"type":"query"},{"current":{"selected":true,"text":["All"],"value":["$__all"]},"datasource":{"type":"prometheus","uid":"ims-prom"},"definition":"label_values(node_uname_info{nodename=~\"$Node\"},instance)","hide":1,"includeAll":true,"label":"Host","multi":true,"name":"host","options":[],"query":{"qryType":1,"query":"label_values(node_uname_info{nodename=~\"$Node\"},instance)","refId":"PrometheusVariableQueryEditor-VariableQuery"},"refresh":1,"regex":"","skipUrlSync":false,"sort":0,"type":"query"}]},"time":{"from":"now-1h","to":"now"},"timepicker":{"refresh_intervals":["10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"browser","title":"Kubernetes Monitoring Dashboard (kubelet Cadvisor, node-exporter)","uid":"795lPdFGk","version":1,"weekStart":""}